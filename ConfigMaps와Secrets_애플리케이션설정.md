# 7 컨피그맵(ConfigMaps)와 시크릿(Secrets)
다룰 내용 : 
- 컨테이너의 주 프로세스 변경
- 애플리케이션에 명령줄 옵션 전달
- 애플리케이션에 노출되는 환경변수 설정
- ConfigMaps로 애플리케이션 설정
- 시크릿으로 민감한 정보 전달

## 7.1 컨테이너화된 애플리케이션 설정

**컨피그맵 개념**
설정 데이터를 최상위 레벨의 쿠버네티스 리소스에 저장하고 이를 기타 다른 리소스 정의와 마찬가지로 git 저장소 혹은 다은 파일 기반 스토리지에 저장할 수 있다.   
설정 데이터를 저장하는 쿠버네티스 리소스를 컨피그맵이라고 한다.   
컨피그맵을 이용해 설정 데이터를 저장할지 여부에 관계없이 다음 방법을 통해 애플리케이션을 구성할 수 있다.   
- 컨테이너에 명령줄 인수 전달
- 각 컨테이너를 위한 사용자 정의 환경변수 지정
- 특수한 유형의 볼륨을 통해 설정 파일을 컨테이너에 마운트

**시크릿 개념**
설정옵션에 민감한 정보가 포함돼 있지 않지만, 어떤 것에는 포함되어 있을 수 있다.   
이를 위해 쿠버네티스는 시크릿이라는 중요한 오브젝트를 제공한다.   

## 7.2 컨테이너에 명령줄 인자 전달
쿠버네티스는 파드 컨테이너 정의에 지정된 실행 명령 대신 다른 실행파일을 실행하거나 다른 명령줄 인자를 사용해 실행하는 것이 가능하다.   

### 7.2.1 도커에서 명령어와 인자 정의
컨테이너에서 실행하는 전체 명령은 **명령어**와 **인자**의 두 부분으로 구성되어 있다.   
   
**ENTRYPOINT와 CMD 이해**   
Dockerfile에서 두 개의 지침은 다음 두 부분을 정의한다.   
- ENTRYPOINT는 컨테이너가 시작될 때 호출될 명령어를 정의한다.   
- CMD는 ENTRYPOINT에 전달되는 인자를 정의한다.   

CMD 명령어를 사용해 이미지가 실행될 때 실행할 명령어를 지정할 수 있지만, 올바른 방법은 ENTRYPOINT 명령어로 실행하고 기본 인자를 정의하려는 경우에만 CMD를 지정하는 것이다.   
그러면 다음과 같이 인자를 지정하지 않고도 이미지를 실행시킬 수 있다.   
~~~
$ docker run <image>
~~~
또는 다음과 같이 추가 인자를 지정해 Dockerfile 안의 CMD에 정의된 값을 재정의한다.   
~~~
$ docker run <image> <arguments>
~~~
   
**shell과 exec 형식간의 차이점**   
두 명령어는 두 가지 서로 다른 형식을 지원한다.   
- shell 형식 - 예 : ENTRYPOINT node app.js   
- exec 형식 - 예 : ENTRYPOINT ["node", "app.js"]   
차이점은 내부에서 정의된 명령을 shell로 호출하는지 여부다.   
exec 형식을 사용한다면 컨테이너 내부에서 node 프로세스를 직접 실행한다(shell 내부 X).   
즉, 프로세스 목록을 나열해보면 메인 프로세스(PID 1)가 node 프로세스임을 확인할 수 있다.    

**예시 : fortune 이미지에서 간격을 설정할 수 있도록 만들기**


### 7.2.2 쿠버네티스에서 명령과 인자 재정의

## 컨테이너의 환경변수 
